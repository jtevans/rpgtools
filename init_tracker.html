<html>
  <head>
    <title>Initiative Tracker</title>

<script language="JavaScript">

var NumChars = 7;
var Characters = new Array();

function Character(name, dex)
{
  this.name = name;
  this.dex = dex;
  this.init = 0;
  return this;
}

function sortCharacters()
{
  var x, y;
  var tempChar = new Character("temp", 0);

  for (x = 0; x < NumChars - 1; ++x)
  {
    for (y = 0; y < NumChars - 1 - x; ++y)
    {
      if (parseInt(Characters[y].init) < parseInt(Characters[y + 1].init) ||
          (parseInt(Characters[y].init) == parseInt(Characters[y + 1].init) &&
           parseInt(Characters[y].dex) < parseInt(Characters[y + 1].dex)))
      {
        tempChar = Characters[y];
        Characters[y] = Characters[y + 1];
        Characters[y + 1] = tempChar;
      } // end if and swap
    }  // end for y
  } // end for x
}

function forceResort()
{
  sortCharacters();
  startHtml();
  showList();
  stopHtml();
  return false;
}

function addNewChar()
{
  newName = window.prompt("What is the character's name?", "Name");
  if (newName)
  {
    newDex = window.prompt("What is the character's dex?", 12);
  }
  if (!newDex)
  {
    return false;
  }

  ++NumChars;
  Characters[NumChars - 1] = new Character(newName, newDex);

  forceResort();
  return false;
}

function initialize()
{
  Characters[0] = new Character("Stryder", 18);
  Characters[1] = new Character("Jarek", 12);
  Characters[2] = new Character("Foneb", 17);
  Characters[3] = new Character("Sydarius", 18);
  Characters[4] = new Character("Burne", 18);
  Characters[5] = new Character("Diardin", 15);
  Characters[6] = new Character("BadGuys", 12);
  sortCharacters();
}

function deleteChar(index)
{
  Characters[index].name = "";
  forceResort();
  return false;
}

function updateInit(index)
{
  Characters[index].init = eval("top.frames[1].document.boxes." + Characters[index].name + "I.value");
  return false;
}

function updateDex(index)
{
  Characters[index].dex = eval("top.frames[1].document.boxes." + Characters[index].name + "D.value");
  return false;
}

function showList()
{
  var Body = window.frames[1].document;
  var x;

  Body.writeln('<form name="boxes">');
  Body.writeln('<a name="box_target">');
  Body.writeln('<table cellpadding=3 cellspacing=0 border=1 align="center">');
  Body.writeln('  <tr>');
  Body.writeln('    <td align="center"><font size="-2">Check<br />to<br />Delete</font></td>');
  Body.writeln('    <th>Name</th>');
  Body.writeln('    <th>Dex</th>');
  Body.writeln('    <th>Initiative</th>');
  Body.writeln('  </tr>');
  for (x = 0; x < NumChars; ++x)
  {
    if (Characters[x].name == "")
    {
      continue;
    }
    Body.writeln('  <tr>');
    Body.writeln('    <td align="center"><input type="checkbox" onClick="top.deleteChar(' + x + ')">');
    Body.writeln('    <td>' + Characters[x].name + '</td>');
    Body.write  ('    <td align="center">');
    Body.write  ('<input type="text" size=2 value=' + Characters[x].dex + ' onBlur="top.updateDex(' + x + ')" name="' + Characters[x].name + 'D">');
    Body.writeln('</td>');
    Body.write  ('    <td align="center">');
    Body.write  ('<input type="text" size=2 value=' + Characters[x].init + ' onBlur="top.updateInit(' + x + ')" name="' + Characters[x].name + 'I">');
    Body.writeln('</td>');
    Body.writeln('  </tr>');
  }
  Body.writeln('</table>');
  Body.writeln('</form>');
}

function startApp()
{
  initialize();
  startHtml();
  showList();
  stopHtml();
}

function startHtml()
{
  var Body = window.frames[1].document;
  Body.open();
  Body.write('<html>\n  <head>\n    <title>Initiative Tracker</title>\n  </head>\n\n');
  Body.write('<body>\n');
}

function stopHtml()
{
  var Body = window.frames[1].document;
  Body.write('</body>\n</html>\n');
  Body.close();
}

</script>

  </head>

<frameset rows="100,*" frameborder=0 framespacing=0 border=0>

  <frame src="./init_menu.html" name="menu">
  <frame src="./init_body.html" name="body">

  <noframes>
  <body>
  Viewing this page requires a browser capable of displaying frames.
  </body>
  </noframes>

</frameset> 
</html>
